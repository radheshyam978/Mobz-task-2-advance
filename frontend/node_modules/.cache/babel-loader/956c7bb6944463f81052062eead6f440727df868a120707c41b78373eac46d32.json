{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vaish\\\\Downloads\\\\Email_Mobile_OTP_Redis-main\\\\Email_Mobile_OTP_Redis-main\\\\frontend\\\\src\\\\Components\\\\LiveUsers.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useMemo, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport api from './Axios';\nimport { socket } from './Socket';\nimport UserModal from './UserModal';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function LiveUsers() {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [showModal, setShowModal] = useState(false);\n  const navigate = useNavigate();\n  const authUser = useMemo(() => {\n    try {\n      return JSON.parse(sessionStorage.getItem('authUser') || 'null');\n    } catch {\n      return null;\n    }\n  }, []);\n  useEffect(() => {\n    function onConnect() {\n      if (authUser !== null && authUser !== void 0 && authUser.email) {\n        socket.emit('join_live_users', {\n          email: authUser.email,\n          firstName: authUser.firstName,\n          lastName: authUser.lastName\n        });\n      } else {\n        socket.emit('viewer_join');\n      }\n    }\n    socket.connect();\n    socket.on('connect', onConnect);\n    socket.on('live_users_update', list => setUsers(Array.isArray(list) ? list : []));\n    return () => {\n      socket.off('connect', onConnect);\n      socket.off('live_users_update');\n      socket.disconnect();\n    };\n  }, [authUser]);\n  const logout = () => {\n    try {\n      socket.emit('leave_live_users');\n    } catch {}\n    sessionStorage.removeItem('authUser');\n    navigate('/login');\n  };\n  const openUser = async email => {\n    try {\n      const {\n        data\n      } = await api.get('/users', {\n        params: {\n          email\n        }\n      });\n      const u = Array.isArray(data === null || data === void 0 ? void 0 : data.user) ? data.user[0] : data === null || data === void 0 ? void 0 : data.user;\n      setSelectedUser(u || null);\n      setShowModal(true);\n    } catch (e) {\n      alert('Error fetching user');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-light min-vh-100\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container py-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-center justify-content-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"mb-3\",\n          children: \"All Users\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 1\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: authUser ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              id: \"me\",\n              className: \"me-3 text-muted\",\n              children: [\"You: \", authUser.firstName || '', \" \", authUser.lastName || '', \" <\", authUser.email || '', \">\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 1\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              id: \"logoutBtn\",\n              className: \"btn btn-outline-secondary btn-sm\",\n              onClick: logout,\n              children: \"Logout\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 1\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"me-3 text-muted\",\n              children: \"You are viewing as a guest\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 1\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/login\",\n              className: \"btn btn-primary btn-sm\",\n              children: \"Login\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 1\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/\",\n              className: \"btn btn-link btn-sm\",\n              children: \"Register\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 1\n            }, this)]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 1\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 1\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"users\",\n        className: \"list-group\",\n        children: [(!users || users.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"list-group-item\",\n          children: \"No users connected.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 1\n        }, this), users && users.map(u => /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"list-group-item list-group-item-action user-item\",\n          onClick: () => openUser(u.email),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex w-100 justify-content-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n              className: \"mb-1\",\n              children: u.email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 1\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              children: u.isOnline ? 'Online' : 'Offline'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 1\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 1\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-1\",\n            children: (u.firstName || '') + ' ' + (u.lastName || '')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 1\n          }, this)]\n        }, u.email, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 1\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 1\n      }, this), /*#__PURE__*/_jsxDEV(UserModal, {\n        user: selectedUser,\n        show: showModal,\n        onClose: () => setShowModal(false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 1\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 1\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 1\n  }, this);\n}\n_s(LiveUsers, \"KhagFoNoTNyfO8k4rYq3aWpVLo8=\", false, function () {\n  return [useNavigate];\n});\n_c = LiveUsers;\nvar _c;\n$RefreshReg$(_c, \"LiveUsers\");","map":{"version":3,"names":["useEffect","useMemo","useState","Link","useNavigate","api","socket","UserModal","jsxDEV","_jsxDEV","Fragment","_Fragment","LiveUsers","_s","users","setUsers","selectedUser","setSelectedUser","showModal","setShowModal","navigate","authUser","JSON","parse","sessionStorage","getItem","onConnect","email","emit","firstName","lastName","connect","on","list","Array","isArray","off","disconnect","logout","removeItem","openUser","data","get","params","u","user","e","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","id","onClick","to","length","map","type","isOnline","show","onClose","_c","$RefreshReg$"],"sources":["C:/Users/vaish/Downloads/Email_Mobile_OTP_Redis-main/Email_Mobile_OTP_Redis-main/frontend/src/Components/LiveUsers.jsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport api from './Axios';\nimport { socket } from './Socket';\nimport UserModal from './UserModal';\n\n\nexport default function LiveUsers() {\nconst [users, setUsers] = useState([]);\nconst [selectedUser, setSelectedUser] = useState(null);\nconst [showModal, setShowModal] = useState(false);\nconst navigate = useNavigate();\nconst authUser = useMemo(() => {\ntry { return JSON.parse(sessionStorage.getItem('authUser') || 'null'); } catch { return null; }\n}, []);\n\n\nuseEffect(() => {\nfunction onConnect() {\nif (authUser?.email) {\nsocket.emit('join_live_users', {\nemail: authUser.email,\nfirstName: authUser.firstName,\nlastName: authUser.lastName,\n});\n} else {\nsocket.emit('viewer_join');\n}\n}\n\n\nsocket.connect();\nsocket.on('connect', onConnect);\nsocket.on('live_users_update', (list) => setUsers(Array.isArray(list) ? list : []));\n\n\nreturn () => {\nsocket.off('connect', onConnect);\nsocket.off('live_users_update');\nsocket.disconnect();\n};\n}, [authUser]);\n\n\nconst logout = () => {\ntry { socket.emit('leave_live_users'); } catch {}\nsessionStorage.removeItem('authUser');\nnavigate('/login');\n};\n\n\nconst openUser = async (email) => {\ntry {\nconst { data } = await api.get('/users', { params: { email } });\nconst u = Array.isArray(data?.user) ? data.user[0] : data?.user;\nsetSelectedUser(u || null);\nsetShowModal(true);\n} catch (e) {\nalert('Error fetching user');\n}\n};\n\nreturn (\n<div className=\"bg-light min-vh-100\">\n<div className=\"container py-4\">\n<div className=\"d-flex align-items-center justify-content-between\">\n<h3 className=\"mb-3\">All Users</h3>\n<div>\n{authUser ? (\n<>\n<span id=\"me\" className=\"me-3 text-muted\">\nYou: {authUser.firstName || ''} {authUser.lastName || ''} &lt;{authUser.email || ''}&gt;\n</span>\n<button id=\"logoutBtn\" className=\"btn btn-outline-secondary btn-sm\" onClick={logout}>Logout</button>\n</>\n) : (\n<>\n<span className=\"me-3 text-muted\">You are viewing as a guest</span>\n<Link to=\"/login\" className=\"btn btn-primary btn-sm\">Login</Link>\n<Link to=\"/\" className=\"btn btn-link btn-sm\">Register</Link>\n</>\n)}\n</div>\n</div>\n\n\n<div id=\"users\" className=\"list-group\">\n{(!users || users.length === 0) && (\n<div className=\"list-group-item\">No users connected.</div>\n)}\n{users && users.map((u) => (\n<button\ntype=\"button\"\nkey={u.email}\nclassName=\"list-group-item list-group-item-action user-item\"\nonClick={() => openUser(u.email)}\n>\n<div className=\"d-flex w-100 justify-content-between\">\n<h6 className=\"mb-1\">{u.email}</h6>\n<small>{u.isOnline ? 'Online' : 'Offline'}</small>\n</div>\n<p className=\"mb-1\">{(u.firstName || '') + ' ' + (u.lastName || '')}</p>\n</button>\n))}\n</div>\n\n\n<UserModal user={selectedUser} show={showModal} onClose={() => setShowModal(false)} />\n</div>\n</div>\n);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}